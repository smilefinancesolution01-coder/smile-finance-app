<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smile AI Super-App</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root { --bg: #131314; --panel: #1e1f20; --text: #e3e3e3; --blue: #8ab4f8; }
        body { background: var(--bg); color: var(--text); font-family: 'Google Sans', Arial; height: 100vh; overflow: hidden; display: flex; }
        
        /* Sidebar Gemini Style */
        .sidebar { width: 280px; background: #1e1f20; padding: 20px; display: flex; flex-direction: column; transition: 0.3s; }
        @media (max-width: 768px) { .sidebar { display: none; } }
        
        .nav-item { padding: 12px; border-radius: 25px; cursor: pointer; transition: 0.2s; display: flex; align-items: center; margin-bottom: 5px; }
        .nav-item:hover { background: #333; }
        .nav-item i { margin-right: 15px; width: 20px; }

        /* Main Area */
        .main-content { flex: 1; display: flex; flex-direction: column; position: relative; }
        .chat-container { flex: 1; overflow-y: auto; padding: 20px 10%; scrollbar-width: none; }
        
        /* Greeting Header */
        .greeting { font-size: 32px; font-weight: 500; margin-top: 50px; background: linear-gradient(to right, #4285f4, #9b72cb, #d96570); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }

        /* Category Grid */
        .category-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 10px; margin-top: 30px; }
        .cat-card { background: var(--panel); padding: 20px; border-radius: 12px; cursor: pointer; text-align: center; border: 1px solid #333; }
        .cat-card:hover { border-color: var(--blue); }

        /* Input Bar */
        .input-wrapper { padding: 20px 10%; background: var(--bg); }
        .input-box { background: var(--panel); border-radius: 32px; padding: 10px 20px; display: flex; align-items: center; border: 1px solid #444; }
        input { background: transparent; border: none; outline: none; color: white; flex: 1; font-size: 16px; padding: 10px; }
        
        .active-mic { color: #ea4335; animation: pulse 1s infinite; }
        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.1); } 100% { transform: scale(1); } }
    </style>
</head>
<body>

    <div class="sidebar">
        <button class="nav-item mb-10"><i class="fa-solid fa-plus"></i> New Chat</button>
        <div class="nav-item"><i class="fa-solid fa-gem"></i> Gems</div>
        <div class="nav-item"><i class="fa-solid fa-clock-rotate-left"></i> History</div>
        <div class="mt-auto">
            <div class="nav-item"><i class="fa-solid fa-gear"></i> Settings</div>
            <div class="nav-item"><i class="fa-solid fa-circle-user"></i> Logout</div>
        </div>
    </div>

    <div class="main-content">
        <header class="p-4 flex justify-between items-center lg:hidden">
            <i class="fa-solid fa-bars text-xl cursor-pointer"></i>
            <span class="font-bold">Smile AI</span>
            <i class="fa-solid fa-circle-user text-xl"></i>
        </header>

        <div class="chat-container" id="chatContainer">
            <h2 id="greetText" class="greeting">Good Morning, Bhai</h2>
            <p class="text-xl text-gray-500 mt-2">Main aapki kaise madad kar sakta hoon?</p>

            <div class="category-grid">
                <div class="cat-card" onclick="ask('Shopping Men')"><i class="fa-solid fa-shirt mb-2 block"></i> Men Fashion</div>
                <div class="cat-card" onclick="ask('Ayurvedic Health')"><i class="fa-solid fa-leaf mb-2 block"></i> Ayurvedic</div>
                <div class="cat-card" onclick="ask('Electronics')"><i class="fa-solid fa-laptop mb-2 block"></i> Gadgets</div>
                <div class="cat-card" onclick="ask('Weight Loss')"><i class="fa-solid fa-weight-scale mb-2 block"></i> Health</div>
            </div>
        </div>

        <div class="input-wrapper">
            <div class="input-box">
                <i id="micIcon" onclick="startVoice()" class="fa-solid fa-microphone text-xl cursor-pointer px-2 text-blue-400"></i>
                <input id="userInput" type="text" placeholder="Smile AI se kuch bhi pucho...">
                <i class="fa-solid fa-paper-plane text-xl cursor-pointer px-2 text-gray-400" onclick="process()"></i>
            </div>
            <p class="text-[10px] text-center mt-2 text-gray-600">Smile AI can make mistakes. Mission 20 Lakh Active.</p>
        </div>
    </div>

    <script>
        // 1. Time-based Greeting
        const hour = new Date().getHours();
        const greetText = document.getElementById('greetText');
        if (hour < 12) greetText.innerText = "Good Morning, Bhai";
        else if (hour < 17) greetText.innerText = "Good Afternoon, Bhai";
        else greetText.innerText = "Good Evening, Bhai";

        // 2. Natural Voice Output (TTS)
        function speak(text) {
            const synth = window.speechSynthesis;
            const utter = new SpeechSynthesisUtterance(text);
            utter.lang = 'hi-IN'; // Natural Hindi
            utter.rate = 1.0;
            synth.speak(utter);
        }

        // 3. Voice Recognition
        const Recognition = window.SpeechRecognition || window.webkitSpeechRecognition;
        const mic = new Recognition();
        mic.lang = 'hi-IN';

        function startVoice() {
            mic.start();
            document.getElementById('micIcon').classList.add('active-mic');
        }

        mic.onresult = (e) => {
            const result = e.results[0][0].transcript;
            document.getElementById('userInput').value = result;
            document.getElementById('micIcon').classList.remove('active-mic');
            process();
        };

        async function process() {
            const input = document.getElementById('userInput');
            const box = document.getElementById('chatContainer');
            const val = input.value;
            if(!val) return;

            input.value = "";
            box.innerHTML += `<div class="mt-8 text-right"><span class="bg-blue-600 p-3 rounded-2xl">${val}</span></div>`;

            try {
                const res = await fetch('https://smile-financial-service-ai.onrender.com/chat', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({message: val})
                });
                const data = await res.json();
                
                // AI Response + Speaking
                box.innerHTML += `<div class="mt-8 flex gap-4"><div class="w-8 h-8 bg-purple-600 rounded-full flex-shrink-0">S</div><div class="text-gray-300 leading-relaxed">${data.reply}</div></div>`;
                speak(data.reply); // AI BOLKE JAWAB DEGA
                
            } catch (e) {
                box.innerHTML += `<div class="text-red-500 mt-4">Server slow hai, bhai...</div>`;
            }
            box.scrollTop = box.scrollHeight;
        }

        function ask(text) {
            document.getElementById('userInput').value = text;
            process();
        }
    </script>
</body>
</html>
